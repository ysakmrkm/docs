{"version":3,"sources":["editor.coffee"],"names":[],"mappings":"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","file":"editor.js","sourceRoot":"../../src/cs/","sourcesContent":["Editor = (input, preview) ->\n  @update = ->\n    preview.innerHTML = markdown.toHTML(input.value);\n\n  input.editor = this\n\n  @update()\n\nid = (id) ->\n  return document.getElementById(id)\n\nnew Editor(id(\"markdown\"), id(\"preview\"));\n\n$ ->\n  $(\".dropdown-button\").dropdown(\n    hover: false\n    constrain_width: 1000\n    alignment: 'right'\n    belowOrigin: true\n  )\n\n  $('#m-share a').leanModal()\n\n  $('#m-share .add a').leanModal(\n    complete: ()->\n      $('#modal-share').find('form')[0].reset()\n      $('#modal-share').find('#email').blur()\n      $('#modal-share').find('.results-inner').remove()\n  )\n\n  $('#m-share .add a').on('click', (e)->\n    e.preventDefault()\n  )\n\n  $('#m-share .show a').on('click', (e)->\n    e.preventDefault()\n\n    docId = location.pathname.split('/')[2]\n\n    $.ajax(\n      url: '/search/files/'+docId\n      data:\n        docId: docId\n    ).then( (data)->\n      sharedAccounts = data\n\n      $('.accounts-inner').remove()\n      source = $('#accounts-template').html()\n      template = Handlebars.compile(source)\n      html = template(sharedAccounts)\n      $('.accounts').append(html)\n\n      $('.shared-account-list .account-item').each( (e)->\n        $target = $(this)\n        $(this).find('a').on('click', (e)->\n          e.preventDefault()\n\n          if $(this).parents('.shared-account-list').find('.account-item').is(':hidden')\n            $('.accounts-inner').empty().append('<p>No accounts.</p>')\n\n          data = {}\n          data['_method'] = 'PUT'\n          data['deleteAccount'] = sharedAccounts[$(this).parents('.account-item').index()]._id\n\n          $.ajax(\n            url: '/files/'+docId\n            type: 'POST'\n            data: data\n          )\n\n          $target.remove()\n\n          if $('.shared-account-list .account-item').length is 0\n            $('#modal-shared-list').closeModal()\n        )\n      )\n    )\n  )\n\n  $('.modal').find('form').on('submit', (e)->\n    e.preventDefault()\n\n    data = {}\n    key = 'email'\n    data[key] = $(this).find('input[name=email]').val()\n\n    $.ajax(\n      url: $(this).attr('action')\n      data: data\n    ).then( (data)->\n      console.log '================================================'\n      console.log 'Get account search result'\n      console.log '================================================'\n      $('.results-inner').remove()\n      source = $('#results-template').html()\n      template = Handlebars.compile(source)\n      html = template(data[0])\n      $('.results').append(html)\n    )\n  )\n\n  $(document).on('submit', '.results form', (e)->\n    e.preventDefault()\n\n    data = {}\n    data['_method'] = 'PUT'\n    key = 'shareAccountsEmail'\n    data[key] = $(this).find('input[name=email]').val()\n\n    $.ajax(\n      url: $(this).attr('action')\n      type: 'POST'\n      data: data\n    ).then( (data)->\n      console.log '================================================'\n      console.log 'Add share account data'\n      console.log '================================================'\n      $('#modal-share').closeModal()\n      $('#modal-share').find('form')[0].reset()\n      $('#modal-share').find('#email').blur()\n      $('#modal-share').find('.results-inner').remove()\n    )\n  )\n\n  return\n"]}